// Generated by BUCKLESCRIPT VERSION 5.0.4, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var React = require("react");
var Caml_format = require("bs-platform/lib/js/caml_format.js");
var Input$ReactHooksTemplate = require("./Input.bs.js");
var Label$ReactHooksTemplate = require("./Label.bs.js");
var Table$ReactHooksTemplate = require("./Table.bs.js");
var Result$ReactHooksTemplate = require("./Result.bs.js");
var Finance$ReactHooksTemplate = require("./Finance.bs.js");

var initialState = /* record */[
  /* annualReturn */"7",
  /* compoundInterest : [] */0,
  /* currBalance */"0",
  /* hasSubmitted */false,
  /* income */"30000",
  /* savingsRate */"67%",
  /* spending */"10000",
  /* targetAmount */"",
  /* targetYear */""
];

function updateFormState(state, field, value) {
  switch (field) {
    case 0 : 
        return /* record */[
                /* annualReturn */value,
                /* compoundInterest */state[/* compoundInterest */1],
                /* currBalance */state[/* currBalance */2],
                /* hasSubmitted */state[/* hasSubmitted */3],
                /* income */state[/* income */4],
                /* savingsRate */state[/* savingsRate */5],
                /* spending */state[/* spending */6],
                /* targetAmount */state[/* targetAmount */7],
                /* targetYear */state[/* targetYear */8]
              ];
    case 1 : 
        return /* record */[
                /* annualReturn */state[/* annualReturn */0],
                /* compoundInterest */state[/* compoundInterest */1],
                /* currBalance */value,
                /* hasSubmitted */state[/* hasSubmitted */3],
                /* income */state[/* income */4],
                /* savingsRate */state[/* savingsRate */5],
                /* spending */state[/* spending */6],
                /* targetAmount */state[/* targetAmount */7],
                /* targetYear */state[/* targetYear */8]
              ];
    case 2 : 
        return /* record */[
                /* annualReturn */state[/* annualReturn */0],
                /* compoundInterest */state[/* compoundInterest */1],
                /* currBalance */state[/* currBalance */2],
                /* hasSubmitted */state[/* hasSubmitted */3],
                /* income */value,
                /* savingsRate */state[/* savingsRate */5],
                /* spending */state[/* spending */6],
                /* targetAmount */state[/* targetAmount */7],
                /* targetYear */state[/* targetYear */8]
              ];
    case 3 : 
        return state;
    case 4 : 
        return /* record */[
                /* annualReturn */state[/* annualReturn */0],
                /* compoundInterest */state[/* compoundInterest */1],
                /* currBalance */state[/* currBalance */2],
                /* hasSubmitted */state[/* hasSubmitted */3],
                /* income */state[/* income */4],
                /* savingsRate */state[/* savingsRate */5],
                /* spending */value,
                /* targetAmount */state[/* targetAmount */7],
                /* targetYear */state[/* targetYear */8]
              ];
    
  }
}

function reducer(state, action) {
  if (typeof action === "number") {
    if (action !== 0) {
      return /* record */[
              /* annualReturn */state[/* annualReturn */0],
              /* compoundInterest */state[/* compoundInterest */1],
              /* currBalance */state[/* currBalance */2],
              /* hasSubmitted */state[/* hasSubmitted */3],
              /* income */state[/* income */4],
              /* savingsRate */Finance$ReactHooksTemplate.savingsRate(Caml_format.caml_float_of_string(state[/* income */4]), Caml_format.caml_float_of_string(state[/* spending */6])).toString() + "%",
              /* spending */state[/* spending */6],
              /* targetAmount */state[/* targetAmount */7],
              /* targetYear */state[/* targetYear */8]
            ];
    } else {
      var yearlySavings = Finance$ReactHooksTemplate.savings(Caml_format.caml_float_of_string(state[/* income */4]), Caml_format.caml_float_of_string(state[/* spending */6])) * 12.0;
      var compoundInterest = Finance$ReactHooksTemplate.compoundInterest(Caml_format.caml_float_of_string(state[/* annualReturn */0]), Caml_format.caml_float_of_string(state[/* currBalance */2]), yearlySavings);
      var targetAmount = Caml_format.caml_float_of_string(state[/* spending */6]) * 12.0 * 25.0;
      var targetYear = Finance$ReactHooksTemplate.getFIREYear(compoundInterest, targetAmount);
      return /* record */[
              /* annualReturn */state[/* annualReturn */0],
              /* compoundInterest */compoundInterest,
              /* currBalance */state[/* currBalance */2],
              /* hasSubmitted */true,
              /* income */state[/* income */4],
              /* savingsRate */state[/* savingsRate */5],
              /* spending */state[/* spending */6],
              /* targetAmount */targetAmount.toString(),
              /* targetYear */targetYear !== undefined ? String(targetYear) : "Not in range"
            ];
    }
  } else {
    return updateFormState(state, action[0], action[1]);
  }
}

function Calc(Props) {
  var match = React.useReducer(reducer, initialState);
  var dispatch = match[1];
  var state = match[0];
  var handleChange = function (name, value) {
    return Curry._1(dispatch, /* InputChange */[
                name,
                value
              ]);
  };
  var handleBlur = function (name, e) {
    return Curry._1(dispatch, /* UpdateSavingsRate */1);
  };
  var handleSubmit = function (e) {
    e.preventDefault();
    return Curry._1(dispatch, /* Submit */0);
  };
  var match$1 = state[/* hasSubmitted */3] === true;
  return React.createElement("main", {
              className: "container"
            }, React.createElement("form", {
                  className: " section",
                  onSubmit: handleSubmit
                }, React.createElement("h1", {
                      className: "title"
                    }, "FIRE Calculator"), React.createElement(Label$ReactHooksTemplate.make, {
                      children: null
                    }, "Current Balance", React.createElement(Input$ReactHooksTemplate.make, {
                          onChange: handleChange,
                          onBlur: handleBlur,
                          name: /* CurrentBalance */1,
                          value: state[/* currBalance */2]
                        })), React.createElement(Label$ReactHooksTemplate.make, {
                      children: null
                    }, "Income (monthly)", React.createElement(Input$ReactHooksTemplate.make, {
                          onChange: handleChange,
                          onBlur: handleBlur,
                          name: /* Income */2,
                          value: state[/* income */4]
                        })), React.createElement(Label$ReactHooksTemplate.make, {
                      children: null
                    }, "Spending (monthly)", React.createElement(Input$ReactHooksTemplate.make, {
                          onChange: handleChange,
                          onBlur: handleBlur,
                          name: /* Spending */4,
                          value: state[/* spending */6]
                        })), React.createElement(Label$ReactHooksTemplate.make, {
                      children: null
                    }, "Savings rate", React.createElement(Input$ReactHooksTemplate.make, {
                          onChange: handleChange,
                          name: /* SavingsRate */3,
                          value: state[/* savingsRate */5]
                        })), React.createElement(Label$ReactHooksTemplate.make, {
                      children: null
                    }, "Expected annual return (%)", React.createElement(Input$ReactHooksTemplate.make, {
                          onChange: handleChange,
                          onBlur: handleBlur,
                          name: /* AnnualReturn */0,
                          value: state[/* annualReturn */0]
                        })), React.createElement("button", {
                      className: "button is-primary"
                    }, "Calculate")), match$1 ? React.createElement(React.Fragment, undefined, React.createElement(Result$ReactHooksTemplate.make, {
                        targetYear: state[/* targetYear */8],
                        targetAmount: state[/* targetAmount */7]
                      }), React.createElement(Table$ReactHooksTemplate.make, {
                        data: state[/* compoundInterest */1]
                      })) : null);
}

var make = Calc;

exports.initialState = initialState;
exports.updateFormState = updateFormState;
exports.reducer = reducer;
exports.make = make;
/* react Not a pure module */
